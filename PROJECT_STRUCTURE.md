# ğŸ“ AIè‚¡ç¥¨åˆ†æç³»ç»Ÿé¡¹ç›®ç»“æ„

**ç‰ˆæœ¬**: v1.0  
**æ›´æ–°æ—¶é—´**: 2025-01-04  
**å¼€å‘è€…**: Corey (lijingfan@pku.org.cn)

## ğŸ—ï¸ é¡¹ç›®ç›®å½•ç»“æ„

```
AI_Stock/                           # é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ ğŸ“¦ Dockeré…ç½®
â”‚   â”œâ”€â”€ docker-compose.yml         # Dockerç¼–æ’é…ç½®
â”‚   â”œâ”€â”€ Dockerfile                 # å®¹å™¨é•œåƒå®šä¹‰
â”‚   â””â”€â”€ .dockerignore              # Dockerå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ âš™ï¸ é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ .env                       # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â”œâ”€â”€ requirements.txt           # Pythonä¾èµ–åŒ…
â”‚   â””â”€â”€ config/                    # é…ç½®æ¨¡å—
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ settings.py            # ä¸»é…ç½®æ–‡ä»¶
â”‚       â””â”€â”€ env_loader.py          # ç¯å¢ƒå˜é‡åŠ è½½å™¨
â”œâ”€â”€ ğŸš€ ä¸»ç¨‹åº
â”‚   â””â”€â”€ main.py                    # ç¨‹åºå…¥å£
â”œâ”€â”€ ğŸ“ æºä»£ç 
â”‚   â””â”€â”€ src/                       # æºä»£ç ç›®å½•
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ database/              # æ•°æ®åº“æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ models.py          # æ•°æ®æ¨¡å‹
â”‚       â”‚   â”œâ”€â”€ database_manager.py # æ•°æ®åº“ç®¡ç†å™¨
â”‚       â”‚   â”œâ”€â”€ clear_database.py  # æ•°æ®åº“æ¸…ç†
â”‚       â”‚   â””â”€â”€ check_crawled_news.py # æ–°é—»æ£€æŸ¥
â”‚       â”œâ”€â”€ frontend/              # Webå‰ç«¯
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ app.py             # Flaskåº”ç”¨
â”‚       â”‚   â”œâ”€â”€ templates/         # HTMLæ¨¡æ¿
â”‚       â”‚   â”‚   â”œâ”€â”€ base.html
â”‚       â”‚   â”‚   â”œâ”€â”€ index.html
â”‚       â”‚   â”‚   â”œâ”€â”€ news.html
â”‚       â”‚   â”‚   â”œâ”€â”€ recommendations.html
â”‚       â”‚   â”‚   â””â”€â”€ simple_test.html
â”‚       â”‚   â””â”€â”€ static/            # é™æ€èµ„æº
â”‚       â”‚       â”œâ”€â”€ css/
â”‚       â”‚       â”œâ”€â”€ js/
â”‚       â”‚       â””â”€â”€ images/
â”‚       â”œâ”€â”€ llm/                   # LLMåˆ†ææ¨¡å—
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ llm_service.py     # LLMæœåŠ¡
â”‚       â”‚   â””â”€â”€ analysis_manager.py # åˆ†æç®¡ç†å™¨
â”‚       â”œâ”€â”€ scrapy_crawler/        # çˆ¬è™«æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ settings.py        # Scrapyè®¾ç½®
â”‚       â”‚   â”œâ”€â”€ items.py           # æ•°æ®é¡¹å®šä¹‰
â”‚       â”‚   â”œâ”€â”€ pipelines.py       # æ•°æ®ç®¡é“
â”‚       â”‚   â”œâ”€â”€ middlewares.py     # ä¸­é—´ä»¶
â”‚       â”‚   â”œâ”€â”€ runner.py          # çˆ¬è™«è¿è¡Œå™¨
â”‚       â”‚   â”œâ”€â”€ selenium_helper.py # SeleniumåŠ©æ‰‹
â”‚       â”‚   â”œâ”€â”€ selenium_middleware.py # Seleniumä¸­é—´ä»¶
â”‚       â”‚   â”œâ”€â”€ spider_runner.py   # çˆ¬è™«æ‰§è¡Œå™¨
â”‚       â”‚   â””â”€â”€ spiders/           # çˆ¬è™«å®šä¹‰
â”‚       â”‚       â”œâ”€â”€ __init__.py
â”‚       â”‚       â””â”€â”€ eastmoney_dynamic_spider.py
â”‚       â”œâ”€â”€ scheduler/             # ä»»åŠ¡è°ƒåº¦
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ scheduler.py       # è°ƒåº¦å™¨
â”‚       â”‚   â””â”€â”€ jobs.py            # ä»»åŠ¡å®šä¹‰
â”‚       â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚           â”œâ”€â”€ __init__.py
â”‚           â””â”€â”€ logger.py          # æ—¥å¿—å·¥å…·
â”œâ”€â”€ ğŸ› ï¸ ç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ deploy.sh                  # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ scripts/                   # è¾…åŠ©è„šæœ¬
â”‚       â”œâ”€â”€ server_database_debug.py      # æ•°æ®åº“è°ƒè¯•
â”‚       â”œâ”€â”€ check_server_environment.py   # ç¯å¢ƒæ£€æŸ¥
â”‚       â”œâ”€â”€ test_docker_deployment.py     # éƒ¨ç½²æµ‹è¯•
â”‚       â””â”€â”€ test_scheduler_tasks.py       # ä»»åŠ¡æµ‹è¯•
â”œâ”€â”€ ğŸ“š æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
â”‚   â””â”€â”€ PROJECT_STRUCTURE.md       # æœ¬æ–‡ä»¶
â””â”€â”€ ğŸ’¾ æ•°æ®ç›®å½• (è¿è¡Œæ—¶åˆ›å»º)
    â”œâ”€â”€ database/                  # æ•°æ®åº“æ–‡ä»¶
    â”‚   â”œâ”€â”€ ai_stock.db           # ä¸»æ•°æ®åº“
    â”‚   â””â”€â”€ backup/               # æ•°æ®åº“å¤‡ä»½
    â”œâ”€â”€ logs/                     # æ—¥å¿—æ–‡ä»¶
    â”‚   â”œâ”€â”€ app.log              # åº”ç”¨æ—¥å¿—
    â”‚   â”œâ”€â”€ crawler.log          # çˆ¬è™«æ—¥å¿—
    â”‚   â””â”€â”€ llm.log              # LLMæ—¥å¿—
    â””â”€â”€ data/                     # ä¸´æ—¶æ•°æ®
```

## ğŸ“¦ æ ¸å¿ƒæ–‡ä»¶è¯´æ˜

### Dockeré…ç½®
- **docker-compose.yml**: å®šä¹‰æœåŠ¡ç¼–æ’ï¼ŒåŒ…å«WebæœåŠ¡ã€æ•°æ®å·æ˜ å°„ã€ç¯å¢ƒå˜é‡
- **Dockerfile**: å®šä¹‰å®¹å™¨é•œåƒæ„å»ºè¿‡ç¨‹ï¼Œå®‰è£…ä¾èµ–å’Œé…ç½®ç¯å¢ƒ
- **.dockerignore**: æ’é™¤ä¸éœ€è¦æ‰“åŒ…åˆ°é•œåƒä¸­çš„æ–‡ä»¶

### é…ç½®æ–‡ä»¶
- **.env**: ç¯å¢ƒå˜é‡é…ç½®ï¼ŒåŒ…å«APIå¯†é’¥ã€æ•°æ®åº“è·¯å¾„ç­‰å…³é”®é…ç½®
- **requirements.txt**: Pythonä¾èµ–åŒ…åˆ—è¡¨
- **config/settings.py**: ä¸»é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰æ‰€æœ‰æ¨¡å—çš„é…ç½®å‚æ•°

### ä¸»ç¨‹åº
- **main.py**: ç¨‹åºå…¥å£ï¼Œæ”¯æŒå¤šç§è¿è¡Œæ¨¡å¼ï¼ˆçˆ¬è™«ã€åˆ†æã€Webã€è°ƒåº¦ã€æœåŠ¡ï¼‰

### æ ¸å¿ƒæ¨¡å—
- **database/**: æ•°æ®åº“æ“ä½œï¼ŒåŒ…å«æ¨¡å‹å®šä¹‰å’Œæ•°æ®ç®¡ç†
- **frontend/**: Webç•Œé¢ï¼ŒFlaskåº”ç”¨å’ŒHTMLæ¨¡æ¿
- **llm/**: AIåˆ†ææ¨¡å—ï¼Œè°ƒç”¨DeepSeek-v3.1è¿›è¡Œæ–°é—»åˆ†æ
- **scrapy_crawler/**: çˆ¬è™«æ¨¡å—ï¼ŒæŠ“å–è´¢ç»æ–°é—»
- **scheduler/**: ä»»åŠ¡è°ƒåº¦ï¼Œå®šæ—¶æ‰§è¡Œçˆ¬è™«å’Œåˆ†æä»»åŠ¡

## ğŸš€ éƒ¨ç½²æ–‡ä»¶

### å¿…é¡»ä¸Šä¼ çš„æ–‡ä»¶
ä¸Šä¼ åˆ°æœåŠ¡å™¨é¡¹ç›®ç›®å½•ï¼š

```
ğŸ“¦ æ ¸å¿ƒæ–‡ä»¶ (å¿…é¡»)
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ .env
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ main.py
â”œâ”€â”€ config/
â””â”€â”€ src/

ğŸ› ï¸ ç®¡ç†æ–‡ä»¶ (å¯é€‰)
â”œâ”€â”€ deploy.sh
â”œâ”€â”€ scripts/
â””â”€â”€ README.md
```

### è¿è¡Œæ—¶åˆ›å»ºçš„ç›®å½•
ç³»ç»Ÿè¿è¡Œæ—¶ä¼šè‡ªåŠ¨åˆ›å»ºï¼š
- `./database/` - æ•°æ®åº“æ–‡ä»¶
- `./logs/` - æ—¥å¿—æ–‡ä»¶
- `./data/` - ä¸´æ—¶æ•°æ®

## ğŸ”§ å…³é”®é…ç½®

### ç¯å¢ƒå˜é‡ (.env)
```bash
# LLMé…ç½® (å¿…é¡»)
LLM_API_KEY=your-volcengine-ark-api-key-here
LLM_MODEL=ep-20250827105540-7wzzj

# WebæœåŠ¡
WEB_HOST=0.0.0.0
WEB_PORT=5000

# çˆ¬è™«é…ç½®
SCRAPY_MAX_ARTICLES=50
SCRAPY_DELAY=1

# æ•°æ®åº“è·¯å¾„ï¼ˆç›¸å¯¹è·¯å¾„ï¼‰
DATABASE_PATH=database/ai_stock.db
```

### Dockerç¼–æ’ (docker-compose.yml)
```yaml
services:
  ai-stock:
    build: .
    ports:
      - "5000:5000"
    volumes:
      - ./database:/app/database
      - ./logs:/app/logs
      - ./data:/app/data
    env_file:
      - .env
```

## ğŸ“Š æ•°æ®æµè½¬

```
è´¢ç»ç½‘ç«™ â†’ çˆ¬è™«æ¨¡å— â†’ æ•°æ®åº“ â†’ LLMåˆ†æ â†’ æ¨èç»“æœ â†’ Webç•Œé¢
    â†“           â†“         â†“        â†“         â†“
  æ–°é—»å†…å®¹    ç»“æ„åŒ–æ•°æ®   å­˜å‚¨    AIåˆ†æ    ç”¨æˆ·è®¿é—®
```

## â° è‡ªåŠ¨ä»»åŠ¡

- **çˆ¬è™«ä»»åŠ¡**: æ¯å°æ—¶ç¬¬0åˆ†é’Ÿæ‰§è¡Œ
- **åˆ†æä»»åŠ¡**: æ¯å°æ—¶ç¬¬10åˆ†é’Ÿæ‰§è¡Œ
- **WebæœåŠ¡**: æŒç»­è¿è¡Œ

## ğŸ¯ ç³»ç»Ÿç‰¹ç‚¹

- **å®Œå…¨DockeråŒ–**: ä¸€é”®éƒ¨ç½²ï¼Œç¯å¢ƒéš”ç¦»
- **è‡ªåŠ¨åŒ–è¿è¡Œ**: æ— éœ€äººå·¥å¹²é¢„ï¼Œ24å°æ—¶è¿è¡Œ
- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„ä»£ç ç»“æ„ï¼Œæ˜“äºç»´æŠ¤
- **æ•°æ®æŒä¹…åŒ–**: é‡å¯åæ•°æ®ä¸ä¸¢å¤±
- **å®æ—¶ç›‘æ§**: æ—¥å¿—è®°å½•ï¼ŒçŠ¶æ€æŸ¥çœ‹

---

**ğŸ‰ é¡¹ç›®ç»“æ„æ¸…æ™°ï¼Œéƒ¨ç½²ç®€å•ï¼Œè¿è¡Œç¨³å®šï¼**
